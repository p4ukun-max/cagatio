<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>El Caga Ti贸</title>

<style>
/* ===== FONDO NAVIDEO ===== */
body {
  margin: 0;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  font-family: Arial, sans-serif;
  color: white;
  background:
    radial-gradient(circle at top, #ff4d4d, #8b0000),
    linear-gradient(180deg, rgba(255,255,255,0.15), transparent);
}

/* Nieve */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  background-image: radial-gradient(white 2px, transparent 2px);
  background-size: 60px 60px;
  opacity: 0.18;
  animation: snow 25s linear infinite;
  pointer-events: none;
}

@keyframes snow {
  from { background-position: 0 0; }
  to { background-position: 0 1200px; }
}

/* ===== CONTENEDOR ===== */
.game-container {
  width: 100%;
  max-width: 360px;
  padding: 16px;
  text-align: center;
  background: rgba(0,0,0,0.25);
  border-radius: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.4);
}

h1 {
  margin: 10px 0;
}

/* ===== TIO ===== */
#tio {
  width: 160px;
  margin: 10px auto;
  display: block;
}

/* ===== CAJAS ===== */
#boxes {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 14px;
  margin: 20px auto;
}

.box {
  width: 100%;
  height: 90px;
  background: #8b4513;
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: transform 0.6s ease;
}

.box img {
  width: 70px;
  transition: opacity 0.3s ease;
}

.box.hide-content img {
  opacity: 0;
}

/* ===== BOTN ===== */
button {
  padding: 14px 22px;
  font-size: 16px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  background: linear-gradient(#ffd700, #ffb700);
  color: #7a0000;
  font-weight: bold;
  box-shadow: 0 6px 0 #cc9000;
}

button:active {
  transform: translateY(4px);
  box-shadow: 0 2px 0 #cc9000;
}

/* ===== MENSAJE ===== */
#message {
  margin-top: 10px;
  font-size: 18px;
  min-height: 24px;
}
</style>
</head>

<body>

<div class="game-container">

  <h1>El Caga Ti贸</h1>

  <img id="tio" src="sprite_0.png">

  <div id="boxes"></div>

  <button id="hitBtn">Pegar al Ti贸</button>

  <p id="message"></p>

</div>

<audio id="hitSound" src="hit.wav"></audio>

<script>
const boxesContainer = document.getElementById("boxes");
const hitBtn = document.getElementById("hitBtn");
const tio = document.getElementById("tio");
const message = document.getElementById("message");
const hitSound = document.getElementById("hitSound");

const gifts = {
  juguete: ["juguete1","juguete2","juguete3","juguete4","juguete5"],
  ropa: ["ropa1","ropa2","ropa3","ropa4","ropa5"],
  dulce: ["dulce1","dulce2","dulce3","dulce4","dulce5"],
  libro: ["libro1","libro2","libro3","libro4","libro5"],
  otro: ["otro1","otro2","otro3","otro4","otro5"]
};

const tioSprites = [
  "sprite_0.png",
  "sprite_1.png",
  "sprite_2.png",
  "sprite_3.png",
  "sprite_4.png",
  "sprite_5.png",
  "sprite_6.png"
];

let boxes = [];
let canChoose = false;
let correctTheme = "";
let isAnimatingTio = false;

/* ===== CREAR 5 CAJAS ===== */
function createBoxes() {
  boxesContainer.innerHTML = "";
  boxes = [];

  const themes = Object.keys(gifts)
    .sort(() => Math.random() - 0.5)
    .slice(0, 5);

  themes.forEach(theme => {
    const imgName = gifts[theme][Math.floor(Math.random() * 5)];
    const box = document.createElement("div");
    box.className = "box";
    box.dataset.item = theme;

    const img = document.createElement("img");
    img.src = `${imgName}.png`;

    box.appendChild(img);
    boxesContainer.appendChild(box);
    boxes.push(box);

    box.addEventListener("click", () => {
      if (!canChoose) return;

      box.classList.remove("hide-content");

      message.textContent =
        box.dataset.item === correctTheme
          ? "?? 隆Regalo correcto!"
          : "?? 隆Carb贸n!";

      canChoose = false;
    });
  });
}

/* ===== ANIMACIN SPRITES TIO ===== */
  // ===== PRECARGA DE SPRITES =====
const preloadedSprites = [];
tioSprites.forEach(src => {
  const img = new Image();
  img.src = src;
  preloadedSprites.push(img);
});
function animateTio() {
  if (isAnimatingTio) return;
  isAnimatingTio = true;

  let frame = 0;
  const totalFrames = tioSprites.length;

  const interval = setInterval(() => {
    tio.src = tioSprites[frame];
    frame++;

    if (frame >= totalFrames) {
      clearInterval(interval);
      tio.src = tioSprites[6];
      isAnimatingTio = false;
    }
  }, 60);
}


/* ===== MEZCLAR CAJAS ===== */
function shuffleBoxes() {
  canChoose = false;
  message.textContent = "";

  boxes.forEach((box, i) => {
    setTimeout(() => {
      const offset = Math.random() * 40 - 20;
      box.style.transform = `translateY(${offset}px) rotate(${Math.random() * 10 - 5}deg)`;
    }, i * 80);
  });

  setTimeout(() => {
    boxes.sort(() => Math.random() - 0.5);
    boxes.forEach(box => boxesContainer.appendChild(box));
    boxes.forEach(box => box.style.transform = "translateY(0) rotate(0)");
    canChoose = true;
  }, 900);
}

/* ===== BOTN ===== */
hitBtn.addEventListener("click", () => {
  if (isAnimatingTio) return;
  correctTheme = Object.keys(gifts)[Math.floor(Math.random() * 5)];

  hitSound.currentTime = 0;
  hitSound.play();

  animateTio(); //  AHORA S FUNCIONA

  boxes.forEach(b => b.classList.add("hide-content"));
  setTimeout(shuffleBoxes, 300);
});
/* ===== INICIO ===== */
createBoxes();
</script>

</body>
</html>
